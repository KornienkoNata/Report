Процедура КнопкаСформироватьНажатие(Кнопка)
	ТабДок = Новый ТабличныйДокумент;
	ТабДок.ТолькоПросмотр = Истина;
	ТабДок.ОриентацияСтраницы = ОриентацияСтраницы.Ландшафт;
	ДатаОтчета = ?(ЗначениеЗаполнено(ДатаФормирования), ДатаФормирования, ТекущаяДата());
	
	Макет =ПолучитьМакет("Макет");
	ОбластьШапка = Макет.ПолучитьОбласть("Шапка");
	ОбластьШапка.Параметры.ДатаФормирования = Формат(ДатаОтчета,"ДЛФ=DD");	
	ТабДок.Вывести(ОбластьШапка);
	
	ОбластьСтрока = Макет.ПолучитьОбласть("Строка");
	
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	РаботникиОрганизаций.Период,
		|	РаботникиОрганизаций.Регистратор,
		|	РаботникиОрганизаций.Сотрудник КАК Сотрудник,
		|	РаботникиОрганизаций.Организация,
		|	РаботникиОрганизаций.ЗанимаемыхСтавок,
		|	РаботникиОрганизаций.Должность,
		|	РаботникиОрганизаций.ПодразделениеОрганизации
		|ИЗ
		|	РегистрСведений.РаботникиОрганизаций КАК РаботникиОрганизаций
		|ГДЕ
		|	РаботникиОрганизаций.ПричинаИзмененияСостояния = ЗНАЧЕНИЕ(Перечисление.ПричиныИзмененияСостояния.ПриемНаРаботу)
		|
		|УПОРЯДОЧИТЬ ПО
		|	Сотрудник";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	ВсегоСтавок = 0;
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		ОбластьСтрока = Макет.ПолучитьОбласть("Строка");
		ЗаполнитьЗначенияСвойств(ОбластьСтрока.Параметры, ВыборкаДетальныеЗаписи);
		ВсегоСтавок = ВсегоСтавок+ВыборкаДетальныеЗаписи.ЗанимаемыхСтавок;
		ТабДок.Вывести(ОбластьСтрока);
	КонецЦикла;
	
	ОбластьПодвал = Макет.ПолучитьОбласть("Подвал");
	ОбластьПодвал.Параметры.ВсегоСтавок = Формат(ВсегоСтавок,"ЧН=0" ) ;	
	ТабДок.Вывести(ОбластьПодвал);


	
	ТабДок.Показать("Принятые на работу сотрудники");
КонецПроцедуры
