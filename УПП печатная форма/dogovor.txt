//по выбранному документу "Поступления товара и услуг". 
Функция Печать() Экспорт
	
	Шапка =  Новый Структура("НомерДоговора, ДатаДоговора, Организация, Контрагент, Должность, РуководительФИО" ); 
	ТабДок = новый ТабличныйДокумент;
	Макет = ПолучитьМакет("Макет");	
	Шапка = ПолучитьРеквизитыДокумента();
	Область = Макет.ПолучитьОбласть("Шапка");
	Область.Параметры.Заполнить(Шапка);		
	ТабДок.Вывести(Область);
	ТабДок.Показать();
	Возврат ТабДок;
КонецФункции


Функция ПолучитьРеквизитыДокумента()
	//получаем данные документа
	
	Результат = Новый Структура("НомерДоговора, ДатаДоговора, Организация, Контрагент, Должность, РуководительФИО" ); 
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ПоступлениеТоваровУслуг.Номер,
		|	ПоступлениеТоваровУслуг.Дата,
		|	ПоступлениеТоваровУслуг.Организация,
		|	ПоступлениеТоваровУслуг.Контрагент
		|ИЗ
		|	Документ.ПоступлениеТоваровУслуг КАК ПоступлениеТоваровУслуг
		|ГДЕ
		|	ПоступлениеТоваровУслуг.Ссылка = &Ссылка";
	
	Запрос.УстановитьПараметр("Ссылка", СсылкаНаОбъект);	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	ВыборкаДетальныеЗаписи.Следующий() ;

	//
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ОтветственныеЛицаОрганизацийСрезПоследних.Должность,
		|	ОтветственныеЛицаОрганизацийСрезПоследних.ФизическоеЛицо
		|ИЗ
		|	РегистрСведений.ОтветственныеЛицаОрганизаций.СрезПоследних(
		|			&ДатаСреза,
		|			СтруктурнаяЕдиница = &Организация
		|				И Должность = &Руководитель) КАК ОтветственныеЛицаОрганизацийСрезПоследних";
	
	Запрос.УстановитьПараметр("ДатаСреза", ТекущаяДата());//ВыборкаДетальныеЗаписи.Дата
	Запрос.УстановитьПараметр("Организация", ВыборкаДетальныеЗаписи.Организация);
	Запрос.УстановитьПараметр("Контрагент", ВыборкаДетальныеЗаписи.Контрагент);
	Запрос.УстановитьПараметр("Руководитель", Справочники.ДолжностиОрганизаций.НайтиПоКоду("00001")); //это "директор", вариант не верный, но пока как выбрать именно должность директора, не придумала
	
	РезультатЗапроса = Запрос.Выполнить();
	
	Выборка = РезультатЗапроса.Выбрать();
	
	Выборка.Следующий();
		
	Результат.	НомерДоговора =  ВыборкаДетальныеЗаписи.Номер;
	Результат.	ДатаДоговора =  Формат(ВыборкаДетальныеЗаписи.Дата, "ДЛФ=DD");
	Результат.Организация =  ВыборкаДетальныеЗаписи.Организация;
	Результат.Контрагент =  ВыборкаДетальныеЗаписи.Контрагент;
	Результат.Должность = Выборка.Должность;
	Результат.РуководительФИО = Выборка.ФизическоеЛицо;
	
	Возврат Результат;
КонецФункции
